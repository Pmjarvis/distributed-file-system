[2025-11-20 23:34:10] --- LOGGING STARTED ---
[2025-11-20 23:34:10] MAIN: Persistent log file initialized for SS ID 1
[2025-11-20 23:34:10] MAIN: Using persistent data directory: ss_data_1
[2025-11-20 23:34:10] MAIN: Loading metadata hash table (post-registration)...
[2025-11-20 23:34:10] No existing metadata file found at ss_data_1/metadata.db (starting fresh)
[2025-11-20 23:34:10] MAIN: No existing metadata DB found for SS ID 1, creating new table
[2025-11-20 23:34:10] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-20 23:34:10] MAIN: Listening for Clients and NS on 10.34.17.66:9001
[2025-11-20 23:34:10] MAIN: Listening for Replication on 10.34.17.66:9002
[2025-11-20 23:34:10] NS_CONTROL: Listener thread started for NS control messages
[2025-11-20 23:34:10] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-20 23:34:10] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-20 23:34:10] MAIN: File scan complete (no existing files found)
[2025-11-20 23:34:10] MAIN: Will send replications to: 10.34.17.143:9003
[2025-11-20 23:34:10] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-20 23:34:16] HANDLER: New NAME SERVER connection from 10.34.17.143 (Req: 32)
[2025-11-20 23:34:16] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-20 23:34:16] Inserted metadata for: file (owner: user, size: 0, is_backup: 0)
[2025-11-20 23:34:16] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-20 23:34:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:34:16] CREATE: File file created by user
[2025-11-20 23:34:16] REPL: Scheduling update for file
[2025-11-20 23:34:16] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:34:16] REPL: Connected to backup. Replicating update for file...
[2025-11-20 23:34:16] REPL: Replicating file (owner: user, size: 0)
[2025-11-20 23:34:16] REPL: Successfully replicated file (0 bytes)
[2025-11-20 23:34:16] REPL: ACK received for file file
[2025-11-20 23:34:19] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 42)
[2025-11-20 23:34:20] WRITE: Created swapfile file (sentence 0)
[2025-11-20 23:34:20] WRITE: Appending sentence 0 to empty file
[2025-11-20 23:34:27] WRITE: Acquired global file lock for commit (file file, sentence 0)
[2025-11-20 23:34:27] WRITE: Committed and deleted swapfile for file (sentence 0)
[2025-11-20 23:34:27] Updated size for file: 12 bytes
[2025-11-20 23:34:27] Updated counts for file: 1 words, 12 chars
[2025-11-20 23:34:27] WRITE: Updated metadata for file (size: 12, words: 1, chars: 12)
[2025-11-20 23:34:27] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-20 23:34:27] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:34:27] WRITE: Completed for file (sentence 0)
[2025-11-20 23:34:27] REPL: Scheduling update for file
[2025-11-20 23:34:27] REPL: Connected to backup. Replicating update for file...
[2025-11-20 23:34:27] REPL: Replicating file (owner: user, size: 12)
[2025-11-20 23:34:27] REPL: Successfully replicated file (12 bytes)
[2025-11-20 23:34:27] REPL: ACK received for file file
[2025-11-20 23:34:30] HANDLER: New NAME SERVER connection from 10.34.17.143 (Req: 34)
[2025-11-20 23:34:31] INFO: NS requesting metadata for file (for VIEW -l)
[2025-11-20 23:34:31] INFO: Returning cached metadata for file (size: 12, words: 1, chars: 12)
[2025-11-20 23:34:31] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:34:35] MAIN: Shutdown detected. Joining threads and performing final cleanup...
[2025-11-20 23:34:35] CLIENT_LISTENER: Thread exiting
[2025-11-20 23:34:36] CHECKPOINT: Thread exiting
[2025-11-20 23:34:36] NS_CONTROL: Listener thread exiting
[2025-11-20 23:34:36] REPL_LISTENER: Thread exiting
[2025-11-20 23:34:40] HEARTBEAT: Thread exiting
[2025-11-20 23:34:40] MAIN: Performing final metadata save (1 entries)...
[2025-11-20 23:34:40] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-20 23:34:40] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:34:40] MAIN: Final metadata save successful
[2025-11-20 23:34:40] Nested metadata hash table freed (1024 locks destroyed)
[2025-11-20 23:34:40] REPL: Worker thread shutting down.
[2025-11-20 23:34:40] --- LOGGING STOPPED ---
[2025-11-20 23:34:58] --- LOGGING STARTED ---
[2025-11-20 23:34:58] MAIN: Persistent log file initialized for SS ID 1
[2025-11-20 23:34:58] MAIN: Using persistent data directory: ss_data_1
[2025-11-20 23:34:58] MAIN: Loading metadata hash table (post-registration)...
[2025-11-20 23:34:58] Loading 1 metadata entries from ss_data_1/metadata.db...
[2025-11-20 23:34:58] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-20 23:34:58] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-20 23:34:58] Inserted metadata for: file (owner: user, size: 12, is_backup: 0)
[2025-11-20 23:34:58] Loaded 1/1 metadata entries from ss_data_1/metadata.db
[2025-11-20 23:34:58] MAIN: Loaded metadata for 1 files from disk
[2025-11-20 23:34:58] MAIN: Listening for Clients and NS on 10.34.17.66:9001
[2025-11-20 23:34:58] MAIN: Listening for Replication on 10.34.17.66:9002
[2025-11-20 23:34:58] NS_CONTROL: Listener thread started for NS control messages
[2025-11-20 23:34:58] NS_CONTROL: Received message type 59 from NS
[2025-11-20 23:34:58] RECOVERY: NS requests sync TO primary (us) FROM backup SS 0 (10.34.17.143:9003)
[2025-11-20 23:34:58] RECOVERY: Waiting for backup SS 0 to initiate recovery connection
[2025-11-20 23:34:58] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-20 23:34:58] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-20 23:34:58] MAIN: File scan complete (0 existing files added post-startup)
[2025-11-20 23:34:58] MAIN: Will send replications to: 10.34.17.143:9003
[2025-11-20 23:34:58] MAIN: This is a recovery. Waiting for NS to coordinate recovery sync...
[2025-11-20 23:34:58] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-20 23:34:59] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:34:59] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:35:00] READ: Handler called for file 'file'
[2025-11-20 23:35:00] READ: Starting read for file file
[2025-11-20 23:35:00] READ: Full path is ss_data_1/files/file
[2025-11-20 23:35:00] READ: File opened successfully, starting to read chunks
[2025-11-20 23:35:00] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:35:00] READ: Chunk 1 sent
[2025-11-20 23:35:00] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:35:00] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:35:04] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:35:04] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:35:04] READ: Handler called for file 'file'
[2025-11-20 23:35:04] READ: Starting read for file file
[2025-11-20 23:35:04] READ: Full path is ss_data_1/files/file
[2025-11-20 23:35:04] READ: File opened successfully, starting to read chunks
[2025-11-20 23:35:04] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:35:04] READ: Chunk 1 sent
[2025-11-20 23:35:04] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:35:04] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:35:09] MAIN: Shutdown detected. Joining threads and performing final cleanup...
[2025-11-20 23:35:09] CHECKPOINT: Thread exiting
[2025-11-20 23:35:09] NS_CONTROL: Listener thread exiting
[2025-11-20 23:35:09] REPL_LISTENER: Thread exiting
[2025-11-20 23:35:09] CLIENT_LISTENER: Thread exiting
[2025-11-20 23:35:13] HEARTBEAT: Thread exiting
[2025-11-20 23:35:13] MAIN: Performing final metadata save (1 entries)...
[2025-11-20 23:35:13] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-20 23:35:13] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:35:13] MAIN: Final metadata save successful
[2025-11-20 23:35:13] Nested metadata hash table freed (1024 locks destroyed)
[2025-11-20 23:35:13] REPL: Worker thread shutting down.
[2025-11-20 23:35:13] --- LOGGING STOPPED ---
[2025-11-20 23:36:02] --- LOGGING STARTED ---
[2025-11-20 23:36:02] MAIN: Persistent log file initialized for SS ID 1
[2025-11-20 23:36:02] MAIN: Using persistent data directory: ss_data_1
[2025-11-20 23:36:02] MAIN: Loading metadata hash table (post-registration)...
[2025-11-20 23:36:02] Loading 1 metadata entries from ss_data_1/metadata.db...
[2025-11-20 23:36:02] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-20 23:36:02] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-20 23:36:02] Inserted metadata for: file (owner: user, size: 12, is_backup: 0)
[2025-11-20 23:36:02] Loaded 1/1 metadata entries from ss_data_1/metadata.db
[2025-11-20 23:36:02] MAIN: Loaded metadata for 1 files from disk
[2025-11-20 23:36:02] MAIN: Listening for Clients and NS on 10.34.17.66:9001
[2025-11-20 23:36:02] MAIN: Listening for Replication on 10.34.17.66:9002
[2025-11-20 23:36:02] NS_CONTROL: Listener thread started for NS control messages
[2025-11-20 23:36:02] NS_CONTROL: Received message type 59 from NS
[2025-11-20 23:36:02] RECOVERY: NS requests sync TO primary (us) FROM backup SS 0 (10.34.17.143:9003)
[2025-11-20 23:36:02] RECOVERY: Waiting for backup SS 0 to initiate recovery connection
[2025-11-20 23:36:02] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-20 23:36:02] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-20 23:36:02] MAIN: File scan complete (0 existing files added post-startup)
[2025-11-20 23:36:02] MAIN: Will send replications to: 10.34.17.143:9003
[2025-11-20 23:36:02] MAIN: This is a recovery. Waiting for NS to coordinate recovery sync...
[2025-11-20 23:36:02] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-20 23:36:03] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:36:03] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:36:04] READ: Handler called for file 'file'
[2025-11-20 23:36:04] READ: Starting read for file file
[2025-11-20 23:36:04] READ: Full path is ss_data_1/files/file
[2025-11-20 23:36:04] READ: File opened successfully, starting to read chunks
[2025-11-20 23:36:04] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:36:04] READ: Chunk 1 sent
[2025-11-20 23:36:04] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:36:04] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:36:14] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:36:14] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:36:14] READ: Handler called for file 'file'
[2025-11-20 23:36:14] READ: Starting read for file file
[2025-11-20 23:36:14] READ: Full path is ss_data_1/files/file
[2025-11-20 23:36:14] READ: File opened successfully, starting to read chunks
[2025-11-20 23:36:14] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:36:14] READ: Chunk 1 sent
[2025-11-20 23:36:14] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:36:14] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:36:18] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 42)
[2025-11-20 23:36:19] WRITE: Created swapfile file (sentence 0)
[2025-11-20 23:36:23] WRITE: Acquired global file lock for commit (file file, sentence 0)
[2025-11-20 23:36:23] WRITE: Committed and deleted swapfile for file (sentence 0)
[2025-11-20 23:36:23] Updated size for file: 22 bytes
[2025-11-20 23:36:23] Updated counts for file: 2 words, 22 chars
[2025-11-20 23:36:23] WRITE: Updated metadata for file (size: 22, words: 2, chars: 22)
[2025-11-20 23:36:23] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-20 23:36:23] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:36:23] WRITE: Completed for file (sentence 0)
[2025-11-20 23:36:23] REPL: Scheduling update for file
[2025-11-20 23:36:23] REPL: Connected to backup. Replicating update for file...
[2025-11-20 23:36:23] REPL: Replicating file (owner: user, size: 22)
[2025-11-20 23:36:23] REPL: Successfully replicated file (22 bytes)
[2025-11-20 23:36:23] REPL: ACK received for file file
[2025-11-20 23:36:28] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:36:28] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:36:29] READ: Handler called for file 'file'
[2025-11-20 23:36:29] READ: Starting read for file file
[2025-11-20 23:36:29] READ: Full path is ss_data_1/files/file
[2025-11-20 23:36:29] READ: File opened successfully, starting to read chunks
[2025-11-20 23:36:29] READ: Chunk 1 - read 22 bytes, is_final=1
[2025-11-20 23:36:29] READ: Chunk 1 sent
[2025-11-20 23:36:29] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:36:29] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:36:35] MAIN: Shutdown detected. Joining threads and performing final cleanup...
[2025-11-20 23:36:35] CLIENT_LISTENER: Thread exiting
[2025-11-20 23:36:35] REPL_LISTENER: Thread exiting
[2025-11-20 23:36:35] NS_CONTROL: Listener thread exiting
[2025-11-20 23:36:35] CHECKPOINT: Thread exiting
[2025-11-20 23:36:37] HEARTBEAT: Thread exiting
[2025-11-20 23:36:37] MAIN: Performing final metadata save (1 entries)...
[2025-11-20 23:36:37] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-20 23:36:37] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:36:37] MAIN: Final metadata save successful
[2025-11-20 23:36:37] Nested metadata hash table freed (1024 locks destroyed)
[2025-11-20 23:36:37] REPL: Worker thread shutting down.
[2025-11-20 23:36:37] --- LOGGING STOPPED ---
[2025-11-20 23:38:14] --- LOGGING STARTED ---
[2025-11-20 23:38:14] MAIN: Persistent log file initialized for SS ID 1
[2025-11-20 23:38:14] MAIN: Using persistent data directory: ss_data_1
[2025-11-20 23:38:14] MAIN: Loading metadata hash table (post-registration)...
[2025-11-20 23:38:14] Loading 1 metadata entries from ss_data_1/metadata.db...
[2025-11-20 23:38:14] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-20 23:38:14] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-20 23:38:14] Inserted metadata for: file (owner: user, size: 22, is_backup: 0)
[2025-11-20 23:38:14] Loaded 1/1 metadata entries from ss_data_1/metadata.db
[2025-11-20 23:38:14] MAIN: Loaded metadata for 1 files from disk
[2025-11-20 23:38:14] MAIN: Listening for Clients and NS on 10.34.17.66:9001
[2025-11-20 23:38:14] MAIN: Listening for Replication on 10.34.17.66:9002
[2025-11-20 23:38:14] NS_CONTROL: Listener thread started for NS control messages
[2025-11-20 23:38:14] NS_CONTROL: Received message type 59 from NS
[2025-11-20 23:38:14] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-20 23:38:14] RECOVERY: NS requests sync TO primary (us) FROM backup SS 0 (10.34.17.143:9003)
[2025-11-20 23:38:14] RECOVERY: Waiting for backup SS 0 to initiate recovery connection
[2025-11-20 23:38:14] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-20 23:38:14] MAIN: File scan complete (0 existing files added post-startup)
[2025-11-20 23:38:14] MAIN: Will send replications to: 10.34.17.143:9003
[2025-11-20 23:38:14] MAIN: This is a recovery. Waiting for NS to coordinate recovery sync...
[2025-11-20 23:38:14] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-20 23:38:21] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:38:21] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:38:21] READ: Handler called for file 'file'
[2025-11-20 23:38:21] READ: Starting read for file file
[2025-11-20 23:38:21] READ: Full path is ss_data_1/files/file
[2025-11-20 23:38:21] READ: File opened successfully, starting to read chunks
[2025-11-20 23:38:21] READ: Chunk 1 - read 22 bytes, is_final=1
[2025-11-20 23:38:21] READ: Chunk 1 sent
[2025-11-20 23:38:21] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:38:21] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:38:29] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:38:29] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:38:29] READ: Handler called for file 'file'
[2025-11-20 23:38:29] READ: Starting read for file file
[2025-11-20 23:38:29] READ: Full path is ss_data_1/files/file
[2025-11-20 23:38:29] READ: File opened successfully, starting to read chunks
[2025-11-20 23:38:29] READ: Chunk 1 - read 22 bytes, is_final=1
[2025-11-20 23:38:29] READ: Chunk 1 sent
[2025-11-20 23:38:29] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:38:29] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:38:44] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:38:44] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:38:44] READ: Handler called for file 'file'
[2025-11-20 23:38:44] READ: Starting read for file file
[2025-11-20 23:38:44] READ: Full path is ss_data_1/files/file
[2025-11-20 23:38:44] READ: File opened successfully, starting to read chunks
[2025-11-20 23:38:44] READ: Chunk 1 - read 22 bytes, is_final=1
[2025-11-20 23:38:44] READ: Chunk 1 sent
[2025-11-20 23:38:44] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:38:44] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:39:35] --- LOGGING STARTED ---
[2025-11-20 23:39:35] MAIN: Persistent log file initialized for SS ID 1
[2025-11-20 23:39:35] MAIN: Using persistent data directory: ss_data_1
[2025-11-20 23:39:35] MAIN: Loading metadata hash table (post-registration)...
[2025-11-20 23:39:35] Loading 1 metadata entries from ss_data_1/metadata.db...
[2025-11-20 23:39:35] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-20 23:39:35] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-20 23:39:35] Inserted metadata for: file (owner: user, size: 22, is_backup: 0)
[2025-11-20 23:39:35] Loaded 1/1 metadata entries from ss_data_1/metadata.db
[2025-11-20 23:39:35] MAIN: Loaded metadata for 1 files from disk
[2025-11-20 23:39:35] MAIN: Listening for Clients and NS on 10.34.17.66:9001
[2025-11-20 23:39:35] MAIN: Listening for Replication on 10.34.17.66:9002
[2025-11-20 23:39:35] NS_CONTROL: Listener thread started for NS control messages
[2025-11-20 23:39:35] NS_CONTROL: Received message type 59 from NS
[2025-11-20 23:39:35] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-20 23:39:35] RECOVERY: NS requests sync TO primary (us) FROM backup SS 0 (10.34.17.143:9003)
[2025-11-20 23:39:35] RECOVERY: Waiting for backup SS 0 to initiate recovery connection
[2025-11-20 23:39:35] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-20 23:39:35] MAIN: File scan complete (0 existing files added post-startup)
[2025-11-20 23:39:35] MAIN: Will send replications to: 10.34.17.143:9003
[2025-11-20 23:39:35] MAIN: This is a recovery. Waiting for NS to coordinate recovery sync...
[2025-11-20 23:39:35] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-20 23:39:39] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:39:39] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:39:39] READ: Handler called for file 'file'
[2025-11-20 23:39:39] READ: Starting read for file file
[2025-11-20 23:39:39] READ: Full path is ss_data_1/files/file
[2025-11-20 23:39:39] READ: File opened successfully, starting to read chunks
[2025-11-20 23:39:39] READ: Chunk 1 - read 22 bytes, is_final=1
[2025-11-20 23:39:39] READ: Chunk 1 sent
[2025-11-20 23:39:39] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:39:39] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:39:45] NS_CONTROL: Lost connection to NS (recv returned 0, errno=11)
[2025-11-20 23:39:45] NS_CONTROL: Listener thread exiting
[2025-11-20 23:39:48] MAIN: Shutdown detected. Joining threads and performing final cleanup...
[2025-11-20 23:39:49] CHECKPOINT: Thread exiting
[2025-11-20 23:39:49] CLIENT_LISTENER: Thread exiting
[2025-11-20 23:39:49] REPL_LISTENER: Thread exiting
[2025-11-20 23:39:50] HEARTBEAT: Thread exiting
[2025-11-20 23:39:50] MAIN: Performing final metadata save (1 entries)...
[2025-11-20 23:39:50] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-20 23:39:50] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:39:50] MAIN: Final metadata save successful
[2025-11-20 23:39:50] Nested metadata hash table freed (1024 locks destroyed)
[2025-11-20 23:39:50] REPL: Worker thread shutting down.
[2025-11-20 23:39:50] --- LOGGING STOPPED ---
