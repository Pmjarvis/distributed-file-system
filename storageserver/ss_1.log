[2025-11-21 21:22:07] --- LOGGING STARTED ---
[2025-11-21 21:22:07] MAIN: Persistent log file initialized for SS ID 1
[2025-11-21 21:22:07] MAIN: Using persistent data directory: ss_data_1
[2025-11-21 21:22:07] MAIN: Loading metadata hash table (post-registration)...
[2025-11-21 21:22:07] No existing metadata file found at ss_data_1/metadata.db (starting fresh)
[2025-11-21 21:22:07] MAIN: No existing metadata DB found for SS ID 1, creating new table
[2025-11-21 21:22:07] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-21 21:22:07] MAIN: Listening for Clients and NS on 127.0.0.1:9003
[2025-11-21 21:22:07] MAIN: Listening for Replication on 127.0.0.1:9004
[2025-11-21 21:22:07] NS_CONTROL: Listener thread started for NS control messages
[2025-11-21 21:22:07] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-21 21:22:07] MAIN: File scan complete (no existing files found)
[2025-11-21 21:22:07] MAIN: Server marked READY (metadata loaded). Accepting client requests.
[2025-11-21 21:22:07] MAIN: Will send replications to: 127.0.0.1:9002
[2025-11-21 21:22:07] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-21 21:22:07] REPL_IN: New incoming replication connection
[2025-11-21 21:22:07] REPL_IN: Receiving replica for f (26 bytes)
[2025-11-21 21:22:07] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-21 21:22:07] REPL_IN: Acquired write lock for f
[2025-11-21 21:22:07] REPL_IN: Finished receiving f
[2025-11-21 21:22:07] DEBUG: Lazily created inner table for outer bucket 523
[2025-11-21 21:22:07] Inserted metadata for: f (owner: po, size: 26, is_backup: 1)
[2025-11-21 21:22:07] REPL_IN: Created metadata for f (owner: po, is_backup=true)
[2025-11-21 21:22:07] REPL_IN: Released write lock for f
[2025-11-21 21:22:07] REPL_IN: New incoming replication connection
[2025-11-21 21:22:07] REPL_IN: Receiving replica for f (26 bytes)
[2025-11-21 21:22:07] REPL_IN: Acquired write lock for f
[2025-11-21 21:22:07] REPL_IN: Finished receiving f
[2025-11-21 21:22:07] Updated metadata for: f
[2025-11-21 21:22:07] REPL_IN: Updated metadata for f (owner: po, size: 26, is_backup=true)
[2025-11-21 21:22:07] REPL_IN: Released write lock for f
[2025-11-21 21:22:21] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 32)
[2025-11-21 21:22:21] DEBUG: Lazily created inner table for outer bucket 924
[2025-11-21 21:22:21] Inserted metadata for: f1 (owner: user, size: 0, is_backup: 0)
[2025-11-21 21:22:21] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:22:21] Successfully saved 2 metadata entries (atomic snapshot)
[2025-11-21 21:22:21] CREATE: File f1 created by user
[2025-11-21 21:22:21] REPL: Scheduling update for f1
[2025-11-21 21:22:21] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:22:21] REPL: Connected to backup. Replicating update for f1...
[2025-11-21 21:22:21] REPL: Replicating f1 (owner: user, size: 0)
[2025-11-21 21:22:21] REPL: Successfully replicated f1 (0 bytes)
[2025-11-21 21:22:21] REPL: ACK received for file f1
[2025-11-21 21:22:23] REPL_IN: New incoming replication connection
[2025-11-21 21:22:23] REPL_IN: Receiving replica for f2 (0 bytes)
[2025-11-21 21:22:23] REPL_IN: Acquired write lock for f2
[2025-11-21 21:22:23] REPL_IN: Finished receiving f2
[2025-11-21 21:22:23] DEBUG: Lazily created inner table for outer bucket 925
[2025-11-21 21:22:23] Inserted metadata for: f2 (owner: user, size: 0, is_backup: 1)
[2025-11-21 21:22:23] REPL_IN: Created metadata for f2 (owner: user, is_backup=true)
[2025-11-21 21:22:23] REPL_IN: Released write lock for f2
[2025-11-21 21:22:25] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 34)
[2025-11-21 21:22:25] INFO: NS requesting metadata for f1 (for VIEW -l)
[2025-11-21 21:22:25] INFO: Returning cached metadata for f1 (size: 0, words: 0, chars: 0)
[2025-11-21 21:22:25] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:22:30] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-21 21:22:30] WRITE: Created swapfile f1 (sentence 0)
[2025-11-21 21:22:30] WRITE: Appending sentence 0 to empty file
[2025-11-21 21:23:07] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:23:07] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:23:07] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:23:07] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:24:07] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:24:07] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:24:07] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:24:07] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:25:07] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:25:07] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:25:07] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:25:07] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:26:07] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:26:07] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:26:07] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:26:07] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:26:28] WRITE: Acquired global file lock for commit (file f1, sentence 0)
[2025-11-21 21:26:28] WRITE: Committed and deleted swapfile for f1 (sentence 0)
[2025-11-21 21:26:28] Updated size for f1: 5357 bytes
[2025-11-21 21:26:28] Updated counts for f1: 2 words, 5357 chars
[2025-11-21 21:26:28] WRITE: Updated metadata for f1 (size: 5357, words: 2, chars: 5357)
[2025-11-21 21:26:28] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:26:28] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:26:28] WRITE: Completed for f1 (sentence 0)
[2025-11-21 21:26:28] REPL: Scheduling update for f1
[2025-11-21 21:26:28] REPL: Connected to backup. Replicating update for f1...
[2025-11-21 21:26:28] REPL: Replicating f1 (owner: user, size: 5357)
[2025-11-21 21:26:28] REPL: Successfully replicated f1 (5357 bytes)
[2025-11-21 21:26:28] REPL: ACK received for file f1
[2025-11-21 21:26:31] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-21 21:26:31] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-21 21:26:31] READ: Handler called for file 'f1'
[2025-11-21 21:26:31] READ: Starting read for file f1
[2025-11-21 21:26:31] READ: Full path is ss_data_1/files/f1
[2025-11-21 21:26:31] READ: File opened successfully, starting to read chunks
[2025-11-21 21:26:31] READ: Chunk 1 - read 4096 bytes, is_final=0
[2025-11-21 21:26:31] READ: Chunk 1 sent
[2025-11-21 21:26:31] READ: Chunk 2 - read 1261 bytes, is_final=1
[2025-11-21 21:26:31] READ: Chunk 2 sent
[2025-11-21 21:26:31] READ: Read complete for f1, sent 2 chunks
[2025-11-21 21:26:31] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:26:43] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 34)
[2025-11-21 21:26:43] INFO: NS requesting metadata for f1 (for VIEW -l)
[2025-11-21 21:26:43] INFO: Returning cached metadata for f1 (size: 5357, words: 2, chars: 5357)
[2025-11-21 21:26:43] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:26:47] MAIN: Shutdown detected. Joining threads and performing final cleanup...
[2025-11-21 21:26:47] NS_CONTROL: Listener thread exiting
[2025-11-21 21:26:47] CLIENT_LISTENER: Thread exiting
[2025-11-21 21:26:47] HEARTBEAT: Thread exiting
[2025-11-21 21:26:47] CHECKPOINT: Thread exiting
[2025-11-21 21:26:47] REPL_LISTENER: Thread exiting
[2025-11-21 21:26:47] MAIN: Performing final metadata save (3 entries)...
[2025-11-21 21:26:47] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:26:47] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:26:47] MAIN: Final metadata save successful
[2025-11-21 21:26:47] Nested metadata hash table freed (1024 locks destroyed)
[2025-11-21 21:26:47] REPL: Worker thread shutting down.
[2025-11-21 21:26:47] --- LOGGING STOPPED ---
[2025-11-21 21:27:28] --- LOGGING STARTED ---
[2025-11-21 21:27:28] MAIN: Persistent log file initialized for SS ID 1
[2025-11-21 21:27:28] MAIN: Using persistent data directory: ss_data_1
[2025-11-21 21:27:28] MAIN: Loading metadata hash table (post-registration)...
[2025-11-21 21:27:28] Loading 3 metadata entries from ss_data_1/metadata.db...
[2025-11-21 21:27:28] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-21 21:27:28] DEBUG: Lazily created inner table for outer bucket 523
[2025-11-21 21:27:28] Inserted metadata for: f (owner: po, size: 26, is_backup: 1)
[2025-11-21 21:27:28] DEBUG: Lazily created inner table for outer bucket 924
[2025-11-21 21:27:28] Inserted metadata for: f1 (owner: user, size: 5357, is_backup: 0)
[2025-11-21 21:27:28] DEBUG: Lazily created inner table for outer bucket 925
[2025-11-21 21:27:28] Inserted metadata for: f2 (owner: user, size: 0, is_backup: 1)
[2025-11-21 21:27:28] Loaded 3/3 metadata entries from ss_data_1/metadata.db
[2025-11-21 21:27:28] MAIN: Loaded metadata for 3 files from disk
[2025-11-21 21:27:28] MAIN: Listening for Clients and NS on 127.0.0.1:9003
[2025-11-21 21:27:28] NS_CONTROL: Listener thread started for NS control messages
[2025-11-21 21:27:28] NS_CONTROL: Received message type 59 from NS
[2025-11-21 21:27:28] RECOVERY: NS requests sync TO primary (us) FROM backup SS 0 (127.0.0.1:9002)
[2025-11-21 21:27:28] RECOVERY: Waiting for backup SS 0 to initiate recovery connection
[2025-11-21 21:27:28] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-21 21:27:28] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-21 21:27:28] MAIN: File scan complete (0 existing files added post-startup)
[2025-11-21 21:27:28] MAIN: Server marked READY (metadata loaded). Accepting client requests.
[2025-11-21 21:27:28] MAIN: Will send replications to: 127.0.0.1:9002
[2025-11-21 21:27:28] MAIN: This is a recovery. Waiting for NS to coordinate recovery sync...
[2025-11-21 21:27:28] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-21 21:27:28] MAIN: Listening for Replication on 127.0.0.1:9004
[2025-11-21 21:27:28] REPL_IN: New incoming replication connection
[2025-11-21 21:27:28] REPL_IN: Receiving replica for f2 (0 bytes)
[2025-11-21 21:27:28] REPL_IN: Acquired write lock for f2
[2025-11-21 21:27:28] REPL_IN: Finished receiving f2
[2025-11-21 21:27:28] Updated metadata for: f2
[2025-11-21 21:27:28] REPL_IN: Updated metadata for f2 (owner: user, size: 0, is_backup=true)
[2025-11-21 21:27:28] REPL_IN: Released write lock for f2
[2025-11-21 21:27:28] REPL_IN: New incoming replication connection
[2025-11-21 21:27:28] REPL_IN: Receiving replica for f (26 bytes)
[2025-11-21 21:27:28] REPL_IN: Acquired write lock for f
[2025-11-21 21:27:28] REPL_IN: Finished receiving f
[2025-11-21 21:27:28] Updated metadata for: f
[2025-11-21 21:27:28] REPL_IN: Updated metadata for f (owner: po, size: 26, is_backup=true)
[2025-11-21 21:27:28] REPL_IN: Released write lock for f
[2025-11-21 21:27:29] REPL_IN: New incoming replication connection
[2025-11-21 21:27:30] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-21 21:27:30] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-21 21:27:30] READ: Handler called for file 'f1'
[2025-11-21 21:27:30] READ: Starting read for file f1
[2025-11-21 21:27:30] READ: Full path is ss_data_1/files/f1
[2025-11-21 21:27:30] READ: File opened successfully, starting to read chunks
[2025-11-21 21:27:30] READ: Chunk 1 - read 4096 bytes, is_final=0
[2025-11-21 21:27:30] READ: Chunk 1 sent
[2025-11-21 21:27:30] READ: Chunk 2 - read 1261 bytes, is_final=1
[2025-11-21 21:27:30] READ: Chunk 2 sent
[2025-11-21 21:27:30] READ: Read complete for f1, sent 2 chunks
[2025-11-21 21:27:30] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:27:41] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-21 21:27:41] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-21 21:27:41] READ: Handler called for file 'f1'
[2025-11-21 21:27:41] READ: Starting read for file f1
[2025-11-21 21:27:41] READ: Full path is ss_data_1/files/f1
[2025-11-21 21:27:41] READ: File opened successfully, starting to read chunks
[2025-11-21 21:27:41] READ: Chunk 1 - read 4096 bytes, is_final=0
[2025-11-21 21:27:41] READ: Chunk 1 sent
[2025-11-21 21:27:41] READ: Chunk 2 - read 1261 bytes, is_final=1
[2025-11-21 21:27:41] READ: Chunk 2 sent
[2025-11-21 21:27:41] READ: Read complete for f1, sent 2 chunks
[2025-11-21 21:27:41] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:27:49] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 41)
[2025-11-21 21:27:49] HANDLER: Routing to ss_handle_stream() for message type 41
[2025-11-21 21:27:49] STREAM: Handler called for file 'f1'
[2025-11-21 21:27:51] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:28:28] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:28:28] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:28:28] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:28:28] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:28:48] REPL_IN: New incoming replication connection
[2025-11-21 21:28:48] REPL_IN: Receiving replica for f2 (4 bytes)
[2025-11-21 21:28:48] REPL_IN: Acquired write lock for f2
[2025-11-21 21:28:48] REPL_IN: Finished receiving f2
[2025-11-21 21:28:48] Updated metadata for: f2
[2025-11-21 21:28:48] REPL_IN: Updated metadata for f2 (owner: user, size: 4, is_backup=true)
[2025-11-21 21:28:48] REPL_IN: Released write lock for f2
[2025-11-21 21:28:51] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 34)
[2025-11-21 21:28:51] INFO: NS requesting metadata for f1 (for VIEW -l)
[2025-11-21 21:28:51] INFO: Returning cached metadata for f1 (size: 5357, words: 2, chars: 5357)
[2025-11-21 21:28:51] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:29:28] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:29:28] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:29:28] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:29:28] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:29:29] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-21 21:29:29] WRITE: Created swapfile f2 (sentence 0)
[2025-11-21 21:29:35] WRITE: Acquired global file lock for commit (file f2, sentence 0)
[2025-11-21 21:29:35] WRITE: Committed and deleted swapfile for f2 (sentence 0)
[2025-11-21 21:29:35] Updated size for f2: 10 bytes
[2025-11-21 21:29:35] Updated counts for f2: 2 words, 10 chars
[2025-11-21 21:29:35] WRITE: Updated metadata for f2 (size: 10, words: 2, chars: 10)
[2025-11-21 21:29:35] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:29:35] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:29:35] WRITE: Completed for f2 (sentence 0)
[2025-11-21 21:29:35] REPL: Scheduling update for f2
[2025-11-21 21:29:35] REPL: Skipping backup file f2 (not replicating backups to prevent cascading)
[2025-11-21 21:29:38] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-21 21:29:38] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-21 21:29:38] READ: Handler called for file 'f2'
[2025-11-21 21:29:38] READ: Starting read for file f2
[2025-11-21 21:29:38] READ: Full path is ss_data_1/files/f2
[2025-11-21 21:29:38] READ: File opened successfully, starting to read chunks
[2025-11-21 21:29:38] READ: Chunk 1 - read 10 bytes, is_final=1
[2025-11-21 21:29:38] READ: Chunk 1 sent
[2025-11-21 21:29:38] READ: Read complete for f2, sent 1 chunks
[2025-11-21 21:29:38] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:29:42] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 41)
[2025-11-21 21:29:42] HANDLER: Routing to ss_handle_stream() for message type 41
[2025-11-21 21:29:42] STREAM: Handler called for file 'f2'
[2025-11-21 21:29:42] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:29:54] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 34)
[2025-11-21 21:29:54] INFO: NS requesting metadata for f2 (for VIEW -l)
[2025-11-21 21:29:54] INFO: Returning cached metadata for f2 (size: 10, words: 2, chars: 10)
[2025-11-21 21:29:54] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:29:54] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 34)
[2025-11-21 21:29:54] INFO: NS requesting metadata for f1 (for VIEW -l)
[2025-11-21 21:29:54] INFO: Returning cached metadata for f1 (size: 5357, words: 2, chars: 5357)
[2025-11-21 21:29:54] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:30:04] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-21 21:30:04] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-21 21:30:04] READ: Handler called for file 'f2'
[2025-11-21 21:30:04] READ: Starting read for file f2
[2025-11-21 21:30:04] READ: Full path is ss_data_1/files/f2
[2025-11-21 21:30:04] READ: File opened successfully, starting to read chunks
[2025-11-21 21:30:04] READ: Chunk 1 - read 10 bytes, is_final=1
[2025-11-21 21:30:04] READ: Chunk 1 sent
[2025-11-21 21:30:04] READ: Read complete for f2, sent 1 chunks
[2025-11-21 21:30:04] HANDLER: Closing connection from 127.0.0.1
[2025-11-21 21:30:21] NS_CONTROL: Received message type 61 from NS
[2025-11-21 21:30:21] HANDLER: Received backup assignment update from NS
[2025-11-21 21:30:21] HANDLER: Backup assignment updated - will replicate to 127.0.0.1:9002 (SS ID 0)
[2025-11-21 21:30:21] HANDLER: Initiating immediate catch-up replication for existing primary files
[2025-11-21 21:30:21] REPL: Scheduling update for f1
[2025-11-21 21:30:21] HANDLER: Catch-up replication scheduling complete (1 primary files queued)
[2025-11-21 21:30:21] NS_CONTROL: Received message type 58 from NS
[2025-11-21 21:30:21] RECOVERY: NS requests sync FROM backup TO primary SS 0 (127.0.0.1:9002)
[2025-11-21 21:30:21] RECOVERY: Connection to primary SS 0 failed, retrying in 1s... (10 attempts left)
[2025-11-21 21:30:21] REPL: Could not connect to backup server at 127.0.0.1:9002
[2025-11-21 21:30:21] REPL: Re-queueing f1 for retry attempt 1
[2025-11-21 21:30:21] REPL: Could not connect to backup server at 127.0.0.1:9002
[2025-11-21 21:30:21] REPL: Re-queueing f1 for retry attempt 2
[2025-11-21 21:30:21] REPL: Could not connect to backup server at 127.0.0.1:9002
[2025-11-21 21:30:21] REPL: Re-queueing f1 for retry attempt 3
[2025-11-21 21:30:21] REPL: Could not connect to backup server at 127.0.0.1:9002
[2025-11-21 21:30:21] REPL: Re-queueing f1 for retry attempt 4
[2025-11-21 21:30:21] REPL: Connected to backup. Replicating update for f1...
[2025-11-21 21:30:21] REPL: Replicating f1 (owner: user, size: 5357)
[2025-11-21 21:30:21] REPL: Successfully replicated f1 (5357 bytes)
[2025-11-21 21:30:21] REPL: ACK received for file f1
[2025-11-21 21:30:23] RECOVERY: Connected to primary SS 0
[2025-11-21 21:30:23] RECOVERY: Sending 3 files to primary SS
[2025-11-21 21:30:23] RECOVERY: Acquired read lock for f2
[2025-11-21 21:30:23] RECOVERY: sendfile failed for f2: sent -1 of 10 bytes
[2025-11-21 21:30:23] RECOVERY: Acquired read lock for f
[2025-11-21 21:30:23] RECOVERY: sendfile failed for f: sent -1 of 26 bytes
[2025-11-21 21:30:23] RECOVERY: Acquired read lock for f1
[2025-11-21 21:30:23] RECOVERY: sendfile failed for f1: sent -1 of 5357 bytes
[2025-11-21 21:30:23] RECOVERY: Sync to primary SS 0 complete (0 files sent)
[2025-11-21 21:30:28] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:30:28] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:30:28] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:30:28] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:31:28] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:31:28] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:31:28] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:31:28] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:32:28] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:32:28] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:32:28] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:32:28] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:33:28] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:33:28] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:33:28] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:33:28] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:34:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:34:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:34:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:34:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:35:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:35:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:35:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:35:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:36:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:36:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:36:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:36:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:37:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:37:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:37:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:37:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:38:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:38:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:38:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:38:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:39:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:39:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:39:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:39:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:40:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:40:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:40:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:40:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:41:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:41:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:41:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:41:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:42:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:42:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:42:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:42:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:43:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:43:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:43:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:43:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:44:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:44:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:44:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:44:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:45:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:45:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:45:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:45:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:46:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:46:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:46:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:46:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:47:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:47:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:47:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:47:29] CHECKPOINT: Metadata saved successfully (3 entries)
[2025-11-21 21:48:29] CHECKPOINT: Saving metadata to disk...
[2025-11-21 21:48:29] Saving metadata to ss_data_1/metadata.db (atomic snapshot)...
[2025-11-21 21:48:29] Successfully saved 3 metadata entries (atomic snapshot)
[2025-11-21 21:48:29] CHECKPOINT: Metadata saved successfully (3 entries)
