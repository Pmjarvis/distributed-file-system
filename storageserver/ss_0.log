[2025-11-20 23:34:01] --- LOGGING STARTED ---
[2025-11-20 23:34:01] MAIN: Persistent log file initialized for SS ID 0
[2025-11-20 23:34:01] MAIN: Using persistent data directory: ss_data_0
[2025-11-20 23:34:01] MAIN: Loading metadata hash table (post-registration)...
[2025-11-20 23:34:01] No existing metadata file found at ss_data_0/metadata.db (starting fresh)
[2025-11-20 23:34:01] MAIN: No existing metadata DB found for SS ID 0, creating new table
[2025-11-20 23:34:01] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-20 23:34:01] MAIN: Listening for Clients and NS on 10.34.17.143:9002
[2025-11-20 23:34:01] MAIN: Listening for Replication on 10.34.17.143:9003
[2025-11-20 23:34:01] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-20 23:34:01] NS_CONTROL: Listener thread started for NS control messages
[2025-11-20 23:34:01] MAIN: File scan complete (no existing files found)
[2025-11-20 23:34:01] MAIN: No replication target assigned (single SS or no backup available)
[2025-11-20 23:34:01] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-20 23:34:01] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-20 23:34:10] NS_CONTROL: Received message type 61 from NS
[2025-11-20 23:34:10] HANDLER: Received backup assignment update from NS
[2025-11-20 23:34:10] HANDLER: Backup assignment updated - will replicate to 10.34.17.66:9002 (SS ID 1)
[2025-11-20 23:34:10] HANDLER: Initiating immediate catch-up replication for existing primary files
[2025-11-20 23:34:10] HANDLER: Catch-up replication scheduling complete (0 primary files queued)
[2025-11-20 23:34:10] NS_CONTROL: Received message type 60 from NS
[2025-11-20 23:34:10] RECOVERY: NS requests re-replication of all files to backup SS 1 (10.34.17.66:9002)
[2025-11-20 23:34:10] RECOVERY: Initiating immediate re-replication for existing primary files
[2025-11-20 23:34:10] RECOVERY: Re-replication scheduling complete (0 primary files queued)
[2025-11-20 23:34:17] REPL_IN: New incoming replication connection
[2025-11-20 23:34:17] REPL_IN: Receiving replica for file (0 bytes)
[2025-11-20 23:34:17] REPL_IN: Acquired write lock for file
[2025-11-20 23:34:17] REPL_IN: Finished receiving file
[2025-11-20 23:34:17] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-20 23:34:17] Inserted metadata for: file (owner: user, size: 0, is_backup: 1)
[2025-11-20 23:34:17] REPL_IN: Created metadata for file (owner: user, is_backup=true)
[2025-11-20 23:34:17] REPL_IN: Released write lock for file
[2025-11-20 23:34:27] REPL_IN: New incoming replication connection
[2025-11-20 23:34:27] REPL_IN: Receiving replica for file (12 bytes)
[2025-11-20 23:34:27] REPL_IN: Acquired write lock for file
[2025-11-20 23:34:27] REPL_IN: Finished receiving file
[2025-11-20 23:34:27] Updated metadata for: file
[2025-11-20 23:34:27] REPL_IN: Updated metadata for file (owner: user, size: 12, is_backup=true)
[2025-11-20 23:34:27] REPL_IN: Released write lock for file
[2025-11-20 23:34:44] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:34:44] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:34:44] READ: Handler called for file 'file'
[2025-11-20 23:34:44] READ: Starting read for file file
[2025-11-20 23:34:44] READ: Full path is ss_data_0/files/file
[2025-11-20 23:34:44] READ: File opened successfully, starting to read chunks
[2025-11-20 23:34:44] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:34:44] READ: Chunk 1 sent
[2025-11-20 23:34:44] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:34:44] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:34:47] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:34:47] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:34:47] READ: Handler called for file 'file'
[2025-11-20 23:34:47] READ: Starting read for file file
[2025-11-20 23:34:47] READ: Full path is ss_data_0/files/file
[2025-11-20 23:34:47] READ: File opened successfully, starting to read chunks
[2025-11-20 23:34:47] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:34:47] READ: Chunk 1 sent
[2025-11-20 23:34:47] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:34:47] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:34:50] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:34:50] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:34:50] READ: Handler called for file 'file'
[2025-11-20 23:34:50] READ: Starting read for file file
[2025-11-20 23:34:50] READ: Full path is ss_data_0/files/file
[2025-11-20 23:34:50] READ: File opened successfully, starting to read chunks
[2025-11-20 23:34:50] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:34:50] READ: Chunk 1 sent
[2025-11-20 23:34:50] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:34:50] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:34:52] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:34:52] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:34:52] READ: Handler called for file 'file'
[2025-11-20 23:34:52] READ: Starting read for file file
[2025-11-20 23:34:52] READ: Full path is ss_data_0/files/file
[2025-11-20 23:34:52] READ: File opened successfully, starting to read chunks
[2025-11-20 23:34:52] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:34:52] READ: Chunk 1 sent
[2025-11-20 23:34:52] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:34:52] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:34:54] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:34:54] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:34:54] READ: Handler called for file 'file'
[2025-11-20 23:34:54] READ: Starting read for file file
[2025-11-20 23:34:54] READ: Full path is ss_data_0/files/file
[2025-11-20 23:34:54] READ: File opened successfully, starting to read chunks
[2025-11-20 23:34:54] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:34:54] READ: Chunk 1 sent
[2025-11-20 23:34:54] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:34:54] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:34:58] NS_CONTROL: Received message type 61 from NS
[2025-11-20 23:34:58] HANDLER: Received backup assignment update from NS
[2025-11-20 23:34:58] HANDLER: Backup assignment updated - will replicate to 10.34.17.66:9002 (SS ID 1)
[2025-11-20 23:34:58] HANDLER: Initiating immediate catch-up replication for existing primary files
[2025-11-20 23:34:58] HANDLER: Catch-up replication scheduling complete (0 primary files queued)
[2025-11-20 23:34:58] NS_CONTROL: Received message type 58 from NS
[2025-11-20 23:34:58] RECOVERY: NS requests sync FROM backup TO primary SS 1 (10.34.17.66:9002)
[2025-11-20 23:34:58] RECOVERY: Failed to connect to primary SS 1 at 10.34.17.66:9002
[2025-11-20 23:35:01] CHECKPOINT: Saving metadata to disk...
[2025-11-20 23:35:01] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:35:01] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:35:01] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-20 23:35:14] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:35:14] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:35:14] READ: Handler called for file 'file'
[2025-11-20 23:35:14] READ: Starting read for file file
[2025-11-20 23:35:14] READ: Full path is ss_data_0/files/file
[2025-11-20 23:35:14] READ: File opened successfully, starting to read chunks
[2025-11-20 23:35:14] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:35:14] READ: Chunk 1 sent
[2025-11-20 23:35:14] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:35:14] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:35:41] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:35:41] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:35:41] READ: Handler called for file 'file'
[2025-11-20 23:35:41] READ: Starting read for file file
[2025-11-20 23:35:41] READ: Full path is ss_data_0/files/file
[2025-11-20 23:35:41] READ: File opened successfully, starting to read chunks
[2025-11-20 23:35:41] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:35:41] READ: Chunk 1 sent
[2025-11-20 23:35:41] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:35:41] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:35:59] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:35:59] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:35:59] READ: Handler called for file 'file'
[2025-11-20 23:35:59] READ: Starting read for file file
[2025-11-20 23:35:59] READ: Full path is ss_data_0/files/file
[2025-11-20 23:35:59] READ: File opened successfully, starting to read chunks
[2025-11-20 23:35:59] READ: Chunk 1 - read 12 bytes, is_final=1
[2025-11-20 23:35:59] READ: Chunk 1 sent
[2025-11-20 23:35:59] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:35:59] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:36:01] CHECKPOINT: Saving metadata to disk...
[2025-11-20 23:36:01] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:36:01] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:36:01] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-20 23:36:02] NS_CONTROL: Received message type 61 from NS
[2025-11-20 23:36:02] HANDLER: Received backup assignment update from NS
[2025-11-20 23:36:02] HANDLER: Backup assignment updated - will replicate to 10.34.17.66:9002 (SS ID 1)
[2025-11-20 23:36:02] HANDLER: Initiating immediate catch-up replication for existing primary files
[2025-11-20 23:36:02] HANDLER: Catch-up replication scheduling complete (0 primary files queued)
[2025-11-20 23:36:02] NS_CONTROL: Received message type 58 from NS
[2025-11-20 23:36:02] RECOVERY: NS requests sync FROM backup TO primary SS 1 (10.34.17.66:9002)
[2025-11-20 23:36:02] RECOVERY: Failed to connect to primary SS 1 at 10.34.17.66:9002
[2025-11-20 23:36:23] REPL_IN: New incoming replication connection
[2025-11-20 23:36:23] REPL_IN: Receiving replica for file (22 bytes)
[2025-11-20 23:36:23] REPL_IN: Acquired write lock for file
[2025-11-20 23:36:23] REPL_IN: Finished receiving file
[2025-11-20 23:36:23] Updated metadata for: file
[2025-11-20 23:36:23] REPL_IN: Updated metadata for file (owner: user, size: 22, is_backup=true)
[2025-11-20 23:36:23] REPL_IN: Released write lock for file
[2025-11-20 23:36:49] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:36:49] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:36:49] READ: Handler called for file 'file'
[2025-11-20 23:36:49] READ: Starting read for file file
[2025-11-20 23:36:49] READ: Full path is ss_data_0/files/file
[2025-11-20 23:36:49] READ: File opened successfully, starting to read chunks
[2025-11-20 23:36:49] READ: Chunk 1 - read 22 bytes, is_final=1
[2025-11-20 23:36:49] READ: Chunk 1 sent
[2025-11-20 23:36:49] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:36:49] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:36:53] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 41)
[2025-11-20 23:36:53] HANDLER: Routing to ss_handle_stream() for message type 41
[2025-11-20 23:36:53] STREAM: Handler called for file 'file'
[2025-11-20 23:36:53] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:36:57] HANDLER: New NAME SERVER connection from 10.34.17.143 (Req: 35)
[2025-11-20 23:36:57] EXEC: Read file file, size=22 bytes, content='litlleeee beforeBACKUP'
[2025-11-20 23:36:57] EXEC: Sending content to NS: 'litlleeee beforeBACKUP'
[2025-11-20 23:36:57] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:36:59] HANDLER: New NAME SERVER connection from 10.34.17.143 (Req: 35)
[2025-11-20 23:36:59] EXEC: Read file file, size=22 bytes, content='litlleeee beforeBACKUP'
[2025-11-20 23:36:59] EXEC: Sending content to NS: 'litlleeee beforeBACKUP'
[2025-11-20 23:36:59] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:37:01] CHECKPOINT: Saving metadata to disk...
[2025-11-20 23:37:01] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:37:01] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:37:01] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-20 23:38:01] CHECKPOINT: Saving metadata to disk...
[2025-11-20 23:38:01] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:38:01] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:38:01] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-20 23:38:09] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 42)
[2025-11-20 23:38:09] WRITE: Created swapfile file (sentence 0)
[2025-11-20 23:38:13] NS_CONTROL: Received message type 61 from NS
[2025-11-20 23:38:13] HANDLER: Received backup assignment update from NS
[2025-11-20 23:38:13] HANDLER: Backup assignment updated - will replicate to 10.34.17.66:9002 (SS ID 1)
[2025-11-20 23:38:13] HANDLER: Initiating immediate catch-up replication for existing primary files
[2025-11-20 23:38:13] HANDLER: Catch-up replication scheduling complete (0 primary files queued)
[2025-11-20 23:38:13] NS_CONTROL: Received message type 58 from NS
[2025-11-20 23:38:13] RECOVERY: NS requests sync FROM backup TO primary SS 1 (10.34.17.66:9002)
[2025-11-20 23:38:14] RECOVERY: Failed to connect to primary SS 1 at 10.34.17.66:9002
[2025-11-20 23:38:17] WRITE: Acquired global file lock for commit (file file, sentence 0)
[2025-11-20 23:38:17] WRITE: Committed and deleted swapfile for file (sentence 0)
[2025-11-20 23:38:17] Updated size for file: 26 bytes
[2025-11-20 23:38:17] Updated counts for file: 3 words, 26 chars
[2025-11-20 23:38:17] WRITE: Updated metadata for file (size: 26, words: 3, chars: 26)
[2025-11-20 23:38:17] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:38:17] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:38:17] WRITE: Completed for file (sentence 0)
[2025-11-20 23:38:17] REPL: Scheduling update for file
[2025-11-20 23:38:17] REPL: Skipping backup file file (not replicating backups to prevent cascading)
[2025-11-20 23:39:01] CHECKPOINT: Saving metadata to disk...
[2025-11-20 23:39:01] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:39:01] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:39:01] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-20 23:39:11] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:39:11] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:39:11] READ: Handler called for file 'file'
[2025-11-20 23:39:11] READ: Starting read for file file
[2025-11-20 23:39:11] READ: Full path is ss_data_0/files/file
[2025-11-20 23:39:11] READ: File opened successfully, starting to read chunks
[2025-11-20 23:39:11] READ: Chunk 1 - read 26 bytes, is_final=1
[2025-11-20 23:39:11] READ: Chunk 1 sent
[2025-11-20 23:39:11] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:39:11] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:39:19] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 40)
[2025-11-20 23:39:19] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-20 23:39:19] READ: Handler called for file 'file'
[2025-11-20 23:39:19] READ: Starting read for file file
[2025-11-20 23:39:19] READ: Full path is ss_data_0/files/file
[2025-11-20 23:39:19] READ: File opened successfully, starting to read chunks
[2025-11-20 23:39:19] READ: Chunk 1 - read 26 bytes, is_final=1
[2025-11-20 23:39:19] READ: Chunk 1 sent
[2025-11-20 23:39:19] READ: Read complete for file, sent 1 chunks
[2025-11-20 23:39:19] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:39:22] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 42)
[2025-11-20 23:39:22] WRITE: Created swapfile file (sentence 0)
[2025-11-20 23:39:28] NS_CONTROL: Received message type 61 from NS
[2025-11-20 23:39:28] HANDLER: Received backup assignment update from NS
[2025-11-20 23:39:28] HANDLER: Backup assignment updated - will replicate to 10.34.17.66:9002 (SS ID 1)
[2025-11-20 23:39:28] HANDLER: Initiating immediate catch-up replication for existing primary files
[2025-11-20 23:39:28] HANDLER: Catch-up replication scheduling complete (0 primary files queued)
[2025-11-20 23:39:28] NS_CONTROL: Received message type 58 from NS
[2025-11-20 23:39:28] RECOVERY: NS requests sync FROM backup TO primary SS 1 (10.34.17.66:9002)
[2025-11-20 23:39:28] WRITE: Acquired global file lock for commit (file file, sentence 0)
[2025-11-20 23:39:28] WRITE: Committed and deleted swapfile for file (sentence 0)
[2025-11-20 23:39:28] Updated size for file: 38 bytes
[2025-11-20 23:39:28] Updated counts for file: 6 words, 38 chars
[2025-11-20 23:39:28] WRITE: Updated metadata for file (size: 38, words: 6, chars: 38)
[2025-11-20 23:39:28] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:39:28] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:39:28] WRITE: Completed for file (sentence 0)
[2025-11-20 23:39:28] REPL: Scheduling update for file
[2025-11-20 23:39:28] REPL: Skipping backup file file (not replicating backups to prevent cascading)
[2025-11-20 23:39:28] RECOVERY: Failed to connect to primary SS 1 at 10.34.17.66:9002
[2025-11-20 23:39:44] MAIN: Shutdown detected. Joining threads and performing final cleanup...
[2025-11-20 23:39:44] CHECKPOINT: Thread exiting
[2025-11-20 23:39:44] NS_CONTROL: Listener thread exiting
[2025-11-20 23:39:44] CLIENT_LISTENER: Thread exiting
[2025-11-20 23:39:45] REPL_LISTENER: Thread exiting
[2025-11-20 23:39:46] HEARTBEAT: Thread exiting
[2025-11-20 23:39:46] MAIN: Performing final metadata save (1 entries)...
[2025-11-20 23:39:46] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:39:46] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-20 23:39:46] MAIN: Final metadata save successful
[2025-11-20 23:39:46] Nested metadata hash table freed (1024 locks destroyed)
[2025-11-20 23:39:46] REPL: Worker thread shutting down.
[2025-11-20 23:39:46] --- LOGGING STOPPED ---
[2025-11-20 23:46:32] --- LOGGING STARTED ---
[2025-11-20 23:46:32] MAIN: Persistent log file initialized for SS ID 0
[2025-11-20 23:46:32] MAIN: Using persistent data directory: ss_data_0
[2025-11-20 23:46:32] MAIN: Loading metadata hash table (post-registration)...
[2025-11-20 23:46:32] Loading 1 metadata entries from ss_data_0/metadata.db...
[2025-11-20 23:46:32] Nested metadata hash table initialized: 1024 outer buckets × 64 inner buckets (1024 locks)
[2025-11-20 23:46:32] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-20 23:46:32] Inserted metadata for: file (owner: user, size: 38, is_backup: 1)
[2025-11-20 23:46:32] Loaded 1/1 metadata entries from ss_data_0/metadata.db
[2025-11-20 23:46:32] MAIN: Loaded metadata for 1 files from disk
[2025-11-20 23:46:32] MAIN: Listening for Clients and NS on 10.34.17.143:9002
[2025-11-20 23:46:32] NS_CONTROL: Listener thread started for NS control messages
[2025-11-20 23:46:32] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-20 23:46:32] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-20 23:46:32] MAIN: File scan complete (0 existing files added post-startup)
[2025-11-20 23:46:32] MAIN: No replication target assigned (single SS or no backup available)
[2025-11-20 23:46:32] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-20 23:46:32] MAIN: Listening for Replication on 10.34.17.143:9003
[2025-11-20 23:47:24] HANDLER: New NAME SERVER connection from 10.34.17.143 (Req: 32)
[2025-11-20 23:47:24] DEBUG: Lazily created inner table for outer bucket 523
[2025-11-20 23:47:24] Inserted metadata for: f (owner: po, size: 0, is_backup: 0)
[2025-11-20 23:47:24] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:47:24] Successfully saved 2 metadata entries (atomic snapshot)
[2025-11-20 23:47:24] CREATE: File f created by po
[2025-11-20 23:47:24] REPL: Scheduling update for f
[2025-11-20 23:47:24] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:47:24] REPL: No backup assigned, skipping replication for f
[2025-11-20 23:47:28] HANDLER: New CLIENT connection from 10.34.17.143 (Req: 42)
[2025-11-20 23:47:28] WRITE: Created swapfile f (sentence 0)
[2025-11-20 23:47:28] WRITE: Appending sentence 0 to empty file
[2025-11-20 23:47:32] CHECKPOINT: Saving metadata to disk...
[2025-11-20 23:47:32] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:47:32] Successfully saved 2 metadata entries (atomic snapshot)
[2025-11-20 23:47:32] CHECKPOINT: Metadata saved successfully (2 entries)
[2025-11-20 23:47:52] WRITE: Acquired global file lock for commit (file f, sentence 0)
[2025-11-20 23:47:52] WRITE: Committed and deleted swapfile for f (sentence 0)
[2025-11-20 23:47:52] Updated size for f: 26 bytes
[2025-11-20 23:47:52] Updated counts for f: 6 words, 26 chars
[2025-11-20 23:47:52] WRITE: Updated metadata for f (size: 26, words: 6, chars: 26)
[2025-11-20 23:47:52] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:47:52] Successfully saved 2 metadata entries (atomic snapshot)
[2025-11-20 23:47:52] WRITE: Completed for f (sentence 0)
[2025-11-20 23:47:52] REPL: Scheduling update for f
[2025-11-20 23:47:52] REPL: No backup assigned, skipping replication for f
[2025-11-20 23:47:56] HANDLER: New NAME SERVER connection from 10.34.17.143 (Req: 35)
[2025-11-20 23:47:56] EXEC: Read file f, size=26 bytes, content='echo "diagnostics... "\nls'
[2025-11-20 23:47:56] EXEC: Sending content to NS: 'echo "diagnostics... "\nls'
[2025-11-20 23:47:56] HANDLER: Closing connection from 10.34.17.143
[2025-11-20 23:48:32] CHECKPOINT: Saving metadata to disk...
[2025-11-20 23:48:32] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:48:32] Successfully saved 2 metadata entries (atomic snapshot)
[2025-11-20 23:48:32] CHECKPOINT: Metadata saved successfully (2 entries)
[2025-11-20 23:48:47] MAIN: Shutdown detected. Joining threads and performing final cleanup...
[2025-11-20 23:48:48] CLIENT_LISTENER: Thread exiting
[2025-11-20 23:48:48] NS_CONTROL: Listener thread exiting
[2025-11-20 23:48:48] CHECKPOINT: Thread exiting
[2025-11-20 23:48:48] REPL_LISTENER: Thread exiting
[2025-11-20 23:48:52] HEARTBEAT: Thread exiting
[2025-11-20 23:48:52] MAIN: Performing final metadata save (2 entries)...
[2025-11-20 23:48:52] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-20 23:48:52] Successfully saved 2 metadata entries (atomic snapshot)
[2025-11-20 23:48:52] MAIN: Final metadata save successful
[2025-11-20 23:48:52] Nested metadata hash table freed (1024 locks destroyed)
[2025-11-20 23:48:52] REPL: Worker thread shutting down.
[2025-11-20 23:48:52] --- LOGGING STOPPED ---
