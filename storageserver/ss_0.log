[2025-11-19 17:18:16] --- LOGGING STARTED ---
[2025-11-19 17:18:16] MAIN: Persistent log file initialized for SS ID 0
[2025-11-19 17:18:16] MAIN: Using persistent data directory: ss_data_0
[2025-11-19 17:18:16] MAIN: Loading metadata hash table (post-registration)...
[2025-11-19 17:18:16] Loading 1 metadata entries from ss_data_0/metadata.db...
[2025-11-19 17:18:16] Nested metadata hash table initialized: 1024 outer buckets Ã— 64 inner buckets (1024 locks)
[2025-11-19 17:18:16] DEBUG: Lazily created inner table for outer bucket 805
[2025-11-19 17:18:16] Inserted metadata for: file (owner: pat, size: 27, is_backup: 0)
[2025-11-19 17:18:16] Loaded 1/1 metadata entries from ss_data_0/metadata.db
[2025-11-19 17:18:16] MAIN: Loaded metadata for 1 files from disk
[2025-11-19 17:18:16] MAIN: Listening for Clients and NS on 127.0.0.1:9001
[2025-11-19 17:18:16] NS_CONTROL: Listener thread started for NS control messages
[2025-11-19 17:18:16] MAIN: Core listener & worker threads started (pre-file-scan). Ready for NS control messages.
[2025-11-19 17:18:16] CHECKPOINT: Thread started (interval: 60 seconds)
[2025-11-19 17:18:16] MAIN: File scan complete (0 existing files added post-startup)
[2025-11-19 17:18:16] MAIN: No replication target assigned (single SS or no backup available)
[2025-11-19 17:18:16] MAIN: Server initialization complete (threads already running). Press Ctrl+C for graceful shutdown.
[2025-11-19 17:18:16] MAIN: Listening for Replication on 127.0.0.1:9002
[2025-11-19 17:18:23] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 32)
[2025-11-19 17:18:23] Updated metadata for: file
[2025-11-19 17:18:23] CREATE: File file created by pat
[2025-11-19 17:18:23] REPL: Scheduling update for file
[2025-11-19 17:18:23] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:18:23] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:18:32] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-19 17:18:32] WRITE: Locked file file (sentence 0)
[2025-11-19 17:18:39] Updated size for file: 15 bytes
[2025-11-19 17:18:39] Updated counts for file: 1 words, 15 chars
[2025-11-19 17:18:39] WRITE: Updated metadata for file (size: 15, words: 1, chars: 15)
[2025-11-19 17:18:39] WRITE: Completed for file (sentence 0)
[2025-11-19 17:18:39] REPL: Scheduling update for file
[2025-11-19 17:18:39] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:18:45] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:18:45] CHECKPOINT: Created checkpoint ss_data_0/checkpoints/file_v1
[2025-11-19 17:18:45] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:18:52] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:18:52] LISTCHECKPOINTS: Listed checkpoints for file
[2025-11-19 17:18:52] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:19:08] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-19 17:19:08] WRITE: Locked file file (sentence 0)
[2025-11-19 17:19:14] Updated size for file: 31 bytes
[2025-11-19 17:19:14] Updated counts for file: 2 words, 31 chars
[2025-11-19 17:19:14] WRITE: Updated metadata for file (size: 31, words: 2, chars: 31)
[2025-11-19 17:19:14] WRITE: Completed for file (sentence 0)
[2025-11-19 17:19:14] REPL: Scheduling update for file
[2025-11-19 17:19:14] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:19:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:19:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:19:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:19:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:19:23] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:19:23] CHECKPOINT: Created checkpoint ss_data_0/checkpoints/file_v2
[2025-11-19 17:19:23] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:19:28] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:19:28] LISTCHECKPOINTS: Listed checkpoints for file
[2025-11-19 17:19:28] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:19:38] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:19:38] Updated size for file: 15 bytes
[2025-11-19 17:19:38] Updated counts for file: 1 words, 15 chars
[2025-11-19 17:19:38] REVERT: Updated metadata for file (size: 15, words: 1, chars: 15)
[2025-11-19 17:19:38] REVERT: Reverted ss_data_0/files/file to checkpoint v1
[2025-11-19 17:19:38] REPL: Scheduling update for file
[2025-11-19 17:19:38] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:19:38] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:19:41] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-19 17:19:41] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-19 17:19:41] READ: Handler called for file 'file'
[2025-11-19 17:19:41] READ: Starting read for file file
[2025-11-19 17:19:41] READ: Full path is ss_data_0/files/file
[2025-11-19 17:19:41] READ: File opened successfully, starting to read chunks
[2025-11-19 17:19:41] READ: Chunk 1 - read 15 bytes, is_final=1
[2025-11-19 17:19:41] READ: Chunk 1 sent
[2025-11-19 17:19:41] READ: Read complete for file, sent 1 chunks
[2025-11-19 17:19:41] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:19:51] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:19:51] LISTCHECKPOINTS: Listed checkpoints for file
[2025-11-19 17:19:51] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:20:07] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:20:07] VIEWCHECKPOINT: Sent checkpoint v1
[2025-11-19 17:20:07] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:20:16] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:20:16] VIEWCHECKPOINT: Sent checkpoint v2
[2025-11-19 17:20:16] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:20:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:20:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:20:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:20:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:20:28] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:20:28] VIEWCHECKPOINT: Sent checkpoint v1
[2025-11-19 17:20:28] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:20:33] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:20:33] VIEWCHECKPOINT: Sent checkpoint v1
[2025-11-19 17:20:33] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:20:39] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:20:39] VIEWCHECKPOINT: Sent checkpoint v2
[2025-11-19 17:20:39] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:21:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:21:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:21:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:21:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:21:54] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-19 17:21:54] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-19 17:21:54] READ: Handler called for file 'file'
[2025-11-19 17:21:54] READ: Starting read for file file
[2025-11-19 17:21:54] READ: Full path is ss_data_0/files/file
[2025-11-19 17:21:54] READ: File opened successfully, starting to read chunks
[2025-11-19 17:21:54] READ: Chunk 1 - read 15 bytes, is_final=1
[2025-11-19 17:21:54] READ: Chunk 1 sent
[2025-11-19 17:21:54] READ: Read complete for file, sent 1 chunks
[2025-11-19 17:21:54] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:01] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:22:01] Updated size for file: 31 bytes
[2025-11-19 17:22:01] Updated counts for file: 2 words, 31 chars
[2025-11-19 17:22:01] REVERT: Updated metadata for file (size: 31, words: 2, chars: 31)
[2025-11-19 17:22:01] REVERT: Reverted ss_data_0/files/file to checkpoint v2
[2025-11-19 17:22:01] REPL: Scheduling update for file
[2025-11-19 17:22:01] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:22:01] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:04] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-19 17:22:04] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-19 17:22:04] READ: Handler called for file 'file'
[2025-11-19 17:22:04] READ: Starting read for file file
[2025-11-19 17:22:04] READ: Full path is ss_data_0/files/file
[2025-11-19 17:22:04] READ: File opened successfully, starting to read chunks
[2025-11-19 17:22:04] READ: Chunk 1 - read 31 bytes, is_final=1
[2025-11-19 17:22:04] READ: Chunk 1 sent
[2025-11-19 17:22:04] READ: Read complete for file, sent 1 chunks
[2025-11-19 17:22:04] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:10] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:22:10] Updated size for file: 15 bytes
[2025-11-19 17:22:10] Updated counts for file: 1 words, 15 chars
[2025-11-19 17:22:10] REVERT: Updated metadata for file (size: 15, words: 1, chars: 15)
[2025-11-19 17:22:10] REVERT: Reverted ss_data_0/files/file to checkpoint v1
[2025-11-19 17:22:10] REPL: Scheduling update for file
[2025-11-19 17:22:10] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:10] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:22:13] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-19 17:22:13] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-19 17:22:13] READ: Handler called for file 'file'
[2025-11-19 17:22:13] READ: Starting read for file file
[2025-11-19 17:22:13] READ: Full path is ss_data_0/files/file
[2025-11-19 17:22:13] READ: File opened successfully, starting to read chunks
[2025-11-19 17:22:13] READ: Chunk 1 - read 15 bytes, is_final=1
[2025-11-19 17:22:13] READ: Chunk 1 sent
[2025-11-19 17:22:13] READ: Read complete for file, sent 1 chunks
[2025-11-19 17:22:13] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:15] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:22:15] Updated size for file: 31 bytes
[2025-11-19 17:22:15] Updated counts for file: 2 words, 31 chars
[2025-11-19 17:22:15] REVERT: Updated metadata for file (size: 31, words: 2, chars: 31)
[2025-11-19 17:22:15] REVERT: Reverted ss_data_0/files/file to checkpoint v2
[2025-11-19 17:22:15] REPL: Scheduling update for file
[2025-11-19 17:22:15] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:15] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:22:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:22:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:22:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:22:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:22:18] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-19 17:22:18] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-19 17:22:18] READ: Handler called for file 'file'
[2025-11-19 17:22:18] READ: Starting read for file file
[2025-11-19 17:22:18] READ: Full path is ss_data_0/files/file
[2025-11-19 17:22:18] READ: File opened successfully, starting to read chunks
[2025-11-19 17:22:18] READ: Chunk 1 - read 31 bytes, is_final=1
[2025-11-19 17:22:18] READ: Chunk 1 sent
[2025-11-19 17:22:18] READ: Read complete for file, sent 1 chunks
[2025-11-19 17:22:18] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:21] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:22:21] Updated size for file: 31 bytes
[2025-11-19 17:22:21] Updated counts for file: 2 words, 31 chars
[2025-11-19 17:22:21] REVERT: Updated metadata for file (size: 31, words: 2, chars: 31)
[2025-11-19 17:22:21] REVERT: Reverted ss_data_0/files/file to checkpoint v2
[2025-11-19 17:22:21] REPL: Scheduling update for file
[2025-11-19 17:22:21] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:22:21] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:29] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-19 17:22:29] WRITE: Locked file file (sentence 0)
[2025-11-19 17:22:34] Updated size for file: 47 bytes
[2025-11-19 17:22:34] Updated counts for file: 3 words, 47 chars
[2025-11-19 17:22:34] WRITE: Updated metadata for file (size: 47, words: 3, chars: 47)
[2025-11-19 17:22:34] WRITE: Completed for file (sentence 0)
[2025-11-19 17:22:34] REPL: Scheduling update for file
[2025-11-19 17:22:34] REPL: No backup assigned, skipping replication for file
[2025-11-19 17:22:37] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-19 17:22:37] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-19 17:22:37] READ: Handler called for file 'file'
[2025-11-19 17:22:37] READ: Starting read for file file
[2025-11-19 17:22:37] READ: Full path is ss_data_0/files/file
[2025-11-19 17:22:37] READ: File opened successfully, starting to read chunks
[2025-11-19 17:22:37] READ: Chunk 1 - read 47 bytes, is_final=1
[2025-11-19 17:22:37] READ: Chunk 1 sent
[2025-11-19 17:22:37] READ: Read complete for file, sent 1 chunks
[2025-11-19 17:22:37] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:41] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:22:41] CHECKPOINT: Created checkpoint ss_data_0/checkpoints/file_v3
[2025-11-19 17:22:41] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:45] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-19 17:22:45] HANDLER: Routing to ss_handle_read() for message type 40
[2025-11-19 17:22:45] READ: Handler called for file 'file'
[2025-11-19 17:22:45] READ: Starting read for file file
[2025-11-19 17:22:45] READ: Full path is ss_data_0/files/file
[2025-11-19 17:22:45] READ: File opened successfully, starting to read chunks
[2025-11-19 17:22:45] READ: Chunk 1 - read 47 bytes, is_final=1
[2025-11-19 17:22:45] READ: Chunk 1 sent
[2025-11-19 17:22:45] READ: Read complete for file, sent 1 chunks
[2025-11-19 17:22:45] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:48] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:22:48] CHECKPOINT: Created checkpoint ss_data_0/checkpoints/file_v2
[2025-11-19 17:22:48] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:22:56] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 46)
[2025-11-19 17:22:56] LISTCHECKPOINTS: Listed checkpoints for file
[2025-11-19 17:22:56] HANDLER: Closing connection from 127.0.0.1
[2025-11-19 17:23:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:23:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:23:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:23:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:24:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:24:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:24:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:24:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:25:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:25:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:25:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:25:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:26:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:26:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:26:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:26:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:27:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:27:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:27:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:27:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:28:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:28:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:28:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:28:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:29:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:29:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:29:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:29:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:30:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:30:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:30:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:30:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:31:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:31:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:31:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:31:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:32:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:32:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:32:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:32:16] CHECKPOINT: Metadata saved successfully (1 entries)
[2025-11-19 17:33:16] CHECKPOINT: Saving metadata to disk...
[2025-11-19 17:33:16] Saving metadata to ss_data_0/metadata.db (atomic snapshot)...
[2025-11-19 17:33:16] Successfully saved 1 metadata entries (atomic snapshot)
[2025-11-19 17:33:16] CHECKPOINT: Metadata saved successfully (1 entries)
