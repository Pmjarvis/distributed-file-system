[2025-11-05 17:19:13] --- LOGGING STARTED ---
[2025-11-05 17:19:13] MAIN: Starting Storage Server...
[2025-11-05 17:19:13] MAIN: Connected to Name Server. Scanning local files...
[2025-11-05 17:19:13] MAIN: Found 26 local files. Registering...
[2025-11-05 17:19:13] MAIN: Registration complete. This SS ID is 0
[2025-11-05 17:19:13] MAIN: All threads started. Server is running.
[2025-11-05 17:19:13] MAIN: Listening for Clients and NS on port 9001
[2025-11-05 17:19:13] MAIN: Listening for Replication on port 9002
[2025-11-05 17:19:32] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 32)
[2025-11-05 17:19:32] CREATE: File first.txt created by nov5_run3
[2025-11-05 17:19:32] REPL: Scheduling update for first.txt
[2025-11-05 17:19:32] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:19:32] REPL: Connected to backup. Replicating update for first.txt...
[2025-11-05 17:19:32] REPL: Successfully replicated first.txt (0 bytes)
[2025-11-05 17:19:32] REPL_IN: New incoming replication connection
[2025-11-05 17:19:32] REPL_IN: Receiving replica for first.txt (0 bytes)
[2025-11-05 17:19:32] REPL_IN: Finished receiving first.txt
[2025-11-05 17:19:32] REPL: ACK received for file first.txt
[2025-11-05 17:19:35] HANDLER: New NAME SERVER connection from 127.0.0.1 (Req: 32)
[2025-11-05 17:19:35] CREATE: File second.txt created by nov5_run3
[2025-11-05 17:19:35] REPL: Scheduling update for second.txt
[2025-11-05 17:19:35] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:19:35] REPL: Connected to backup. Replicating update for second.txt...
[2025-11-05 17:19:35] REPL_IN: New incoming replication connection
[2025-11-05 17:19:35] REPL_IN: Receiving replica for second.txt (0 bytes)
[2025-11-05 17:19:35] REPL: Successfully replicated second.txt (0 bytes)
[2025-11-05 17:19:35] REPL_IN: Finished receiving second.txt
[2025-11-05 17:19:35] REPL: ACK received for file second.txt
[2025-11-05 17:19:39] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:19:39] READ: Starting read for file first.txt
[2025-11-05 17:19:39] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:19:39] READ: File opened successfully, starting to read chunks
[2025-11-05 17:19:39] READ: File is empty, sending empty final chunk
[2025-11-05 17:19:39] READ: Read complete for first.txt, sent 0 chunks
[2025-11-05 17:19:39] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:19:43] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:19:43] READ: Starting read for file second.txt
[2025-11-05 17:19:43] READ: Full path is ss_data/files/second.txt
[2025-11-05 17:19:43] READ: File opened successfully, starting to read chunks
[2025-11-05 17:19:43] READ: File is empty, sending empty final chunk
[2025-11-05 17:19:43] READ: Read complete for second.txt, sent 0 chunks
[2025-11-05 17:19:43] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:20:05] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:20:05] READ: Starting read for file first.txt
[2025-11-05 17:20:05] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:20:05] READ: File opened successfully, starting to read chunks
[2025-11-05 17:20:05] READ: File is empty, sending empty final chunk
[2025-11-05 17:20:05] READ: Read complete for first.txt, sent 0 chunks
[2025-11-05 17:20:05] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:20:13] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:20:13] READ: Starting read for file first.txt
[2025-11-05 17:20:13] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:20:13] READ: File opened successfully, starting to read chunks
[2025-11-05 17:20:13] READ: File is empty, sending empty final chunk
[2025-11-05 17:20:13] READ: Read complete for first.txt, sent 0 chunks
[2025-11-05 17:20:13] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:21:03] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:21:03] READ: Starting read for file first.txt
[2025-11-05 17:21:03] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:21:03] READ: File opened successfully, starting to read chunks
[2025-11-05 17:21:03] READ: File is empty, sending empty final chunk
[2025-11-05 17:21:03] READ: Read complete for first.txt, sent 0 chunks
[2025-11-05 17:21:03] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:21:53] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 45)
[2025-11-05 17:21:53] UNDO: No undo history for first.txt
[2025-11-05 17:21:53] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:22:39] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:22:39] WRITE: Locked file first.txt (sentence 1)
[2025-11-05 17:22:44] WRITE: Completed for first.txt (sentence 1)
[2025-11-05 17:22:44] REPL: Scheduling update for first.txt
[2025-11-05 17:22:44] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:22:44] REPL: Connected to backup. Replicating update for first.txt...
[2025-11-05 17:22:44] REPL_IN: New incoming replication connection
[2025-11-05 17:22:44] REPL_IN: Receiving replica for first.txt (5 bytes)
[2025-11-05 17:22:44] REPL: Successfully replicated first.txt (5 bytes)
[2025-11-05 17:22:44] REPL_IN: Finished receiving first.txt
[2025-11-05 17:22:44] REPL: ACK received for file first.txt
[2025-11-05 17:22:50] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:22:50] READ: Starting read for file first.txt
[2025-11-05 17:22:50] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:22:50] READ: File opened successfully, starting to read chunks
[2025-11-05 17:22:50] READ: Chunk 1 - read 5 bytes, is_final=1
[2025-11-05 17:22:50] READ: Chunk 1 sent
[2025-11-05 17:22:50] READ: Read complete for first.txt, sent 1 chunks
[2025-11-05 17:22:50] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:22:56] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:22:56] READ: Starting read for file first.txt
[2025-11-05 17:22:56] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:22:56] READ: File opened successfully, starting to read chunks
[2025-11-05 17:22:56] READ: Chunk 1 - read 5 bytes, is_final=1
[2025-11-05 17:22:56] READ: Chunk 1 sent
[2025-11-05 17:22:56] READ: Read complete for first.txt, sent 1 chunks
[2025-11-05 17:22:56] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:23:00] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:23:00] WRITE: Locked file first.txt (sentence 0)
[2025-11-05 17:23:05] WRITE: Completed for first.txt (sentence 0)
[2025-11-05 17:23:05] REPL: Scheduling update for first.txt
[2025-11-05 17:23:05] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:23:05] REPL: Connected to backup. Replicating update for first.txt...
[2025-11-05 17:23:05] REPL_IN: New incoming replication connection
[2025-11-05 17:23:05] REPL_IN: Receiving replica for first.txt (11 bytes)
[2025-11-05 17:23:05] REPL: Successfully replicated first.txt (11 bytes)
[2025-11-05 17:23:05] REPL_IN: Finished receiving first.txt
[2025-11-05 17:23:05] REPL: ACK received for file first.txt
[2025-11-05 17:23:10] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:23:10] READ: Starting read for file first.txt
[2025-11-05 17:23:10] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:23:10] READ: File opened successfully, starting to read chunks
[2025-11-05 17:23:10] READ: Chunk 1 - read 11 bytes, is_final=1
[2025-11-05 17:23:10] READ: Chunk 1 sent
[2025-11-05 17:23:10] READ: Read complete for first.txt, sent 1 chunks
[2025-11-05 17:23:10] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:23:16] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:23:16] WRITE: Locked file first.txt (sentence 0)
[2025-11-05 17:23:30] WRITE: Completed for first.txt (sentence 0)
[2025-11-05 17:23:30] REPL: Scheduling update for first.txt
[2025-11-05 17:23:30] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:23:30] REPL: Connected to backup. Replicating update for first.txt...
[2025-11-05 17:23:30] REPL_IN: New incoming replication connection
[2025-11-05 17:23:30] REPL_IN: Receiving replica for first.txt (38 bytes)
[2025-11-05 17:23:30] REPL: Successfully replicated first.txt (38 bytes)
[2025-11-05 17:23:30] REPL_IN: Finished receiving first.txt
[2025-11-05 17:23:30] REPL: ACK received for file first.txt
[2025-11-05 17:23:33] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:23:33] READ: Starting read for file first.txt
[2025-11-05 17:23:33] READ: Full path is ss_data/files/first.txt
[2025-11-05 17:23:33] READ: File opened successfully, starting to read chunks
[2025-11-05 17:23:33] READ: Chunk 1 - read 38 bytes, is_final=1
[2025-11-05 17:23:33] READ: Chunk 1 sent
[2025-11-05 17:23:33] READ: Read complete for first.txt, sent 1 chunks
[2025-11-05 17:23:33] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:23:54] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:23:54] WRITE: Locked file first.txt (sentence 1)
[2025-11-05 17:23:54] WRITE: Sentence index 1 out of range (max 0)
[2025-11-05 17:23:54] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:24:00] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:24:00] WRITE: Locked file second.txt (sentence 100)
[2025-11-05 17:24:15] WRITE: Completed for second.txt (sentence 100)
[2025-11-05 17:24:15] REPL: Scheduling update for second.txt
[2025-11-05 17:24:15] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:24:15] REPL: Connected to backup. Replicating update for second.txt...
[2025-11-05 17:24:15] REPL_IN: New incoming replication connection
[2025-11-05 17:24:15] REPL_IN: Receiving replica for second.txt (22 bytes)
[2025-11-05 17:24:15] REPL: Successfully replicated second.txt (22 bytes)
[2025-11-05 17:24:15] REPL_IN: Finished receiving second.txt
[2025-11-05 17:24:15] REPL: ACK received for file second.txt
[2025-11-05 17:24:19] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:24:19] READ: Starting read for file second.txt
[2025-11-05 17:24:19] READ: Full path is ss_data/files/second.txt
[2025-11-05 17:24:19] READ: File opened successfully, starting to read chunks
[2025-11-05 17:24:19] READ: Chunk 1 - read 22 bytes, is_final=1
[2025-11-05 17:24:19] READ: Chunk 1 sent
[2025-11-05 17:24:19] READ: Read complete for second.txt, sent 1 chunks
[2025-11-05 17:24:19] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:24:41] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:24:41] WRITE: Locked file second.txt (sentence 2)
[2025-11-05 17:24:41] WRITE: Sentence index 2 out of range (max 1)
[2025-11-05 17:24:41] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:24:46] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:24:46] WRITE: Locked file second.txt (sentence 0)
[2025-11-05 17:24:53] WRITE: Completed for second.txt (sentence 0)
[2025-11-05 17:24:53] REPL: Scheduling update for second.txt
[2025-11-05 17:24:53] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:24:53] REPL: Connected to backup. Replicating update for second.txt...
[2025-11-05 17:24:53] REPL: Successfully replicated second.txt (26 bytes)
[2025-11-05 17:24:53] REPL_IN: New incoming replication connection
[2025-11-05 17:24:53] REPL_IN: Receiving replica for second.txt (26 bytes)
[2025-11-05 17:24:53] REPL_IN: Finished receiving second.txt
[2025-11-05 17:24:53] REPL: ACK received for file second.txt
[2025-11-05 17:24:57] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 41)
[2025-11-05 17:24:57] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:25:13] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:25:13] WRITE: Locked file second.txt (sentence 1)
[2025-11-05 17:25:19] WRITE: Completed for second.txt (sentence 1)
[2025-11-05 17:25:19] REPL: Scheduling update for second.txt
[2025-11-05 17:25:19] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:25:19] REPL: Connected to backup. Replicating update for second.txt...
[2025-11-05 17:25:19] REPL_IN: New incoming replication connection
[2025-11-05 17:25:19] REPL_IN: Receiving replica for second.txt (28 bytes)
[2025-11-05 17:25:19] REPL: Successfully replicated second.txt (28 bytes)
[2025-11-05 17:25:19] REPL_IN: Finished receiving second.txt
[2025-11-05 17:25:19] REPL: ACK received for file second.txt
[2025-11-05 17:25:23] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 41)
[2025-11-05 17:25:24] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:25:30] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:25:30] WRITE: Locked file second.txt (sentence 3)
[2025-11-05 17:25:30] WRITE: Sentence index 3 out of range (max 2)
[2025-11-05 17:25:30] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:25:33] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 42)
[2025-11-05 17:25:33] WRITE: Locked file second.txt (sentence 2)
[2025-11-05 17:25:38] WRITE: Completed for second.txt (sentence 2)
[2025-11-05 17:25:38] REPL: Scheduling update for second.txt
[2025-11-05 17:25:38] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:25:38] REPL: Connected to backup. Replicating update for second.txt...
[2025-11-05 17:25:38] REPL_IN: New incoming replication connection
[2025-11-05 17:25:38] REPL_IN: Receiving replica for second.txt (32 bytes)
[2025-11-05 17:25:38] REPL: Successfully replicated second.txt (32 bytes)
[2025-11-05 17:25:38] REPL_IN: Finished receiving second.txt
[2025-11-05 17:25:38] REPL: ACK received for file second.txt
[2025-11-05 17:25:41] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 41)
[2025-11-05 17:25:41] HANDLER: Closing connection from 127.0.0.1
[2025-11-05 17:26:23] HANDLER: New CLIENT connection from 127.0.0.1 (Req: 40)
[2025-11-05 17:26:23] READ: Starting read for file second.txt
[2025-11-05 17:26:23] READ: Full path is ss_data/files/second.txt
[2025-11-05 17:26:23] READ: File opened successfully, starting to read chunks
[2025-11-05 17:26:23] READ: Chunk 1 - read 32 bytes, is_final=1
[2025-11-05 17:26:23] READ: Chunk 1 sent
[2025-11-05 17:26:23] READ: Read complete for second.txt, sent 1 chunks
[2025-11-05 17:26:23] HANDLER: Closing connection from 127.0.0.1
